#!/bin/bash

# Check if a theme exists
DIR=$HOME/.themes/$1
if [ -d "$DIR" ] && \
    [ -f "$DIR/theme.Xresources" ] && \
    [ -d "$DIR/wallpapers" ] ; then

  # Use base .Xresources file and append theme resources
  echo -e "! This file is automatically generated from the current theme\n" \
    > $HOME/.Xresources
  cat $HOME/.themes/base.Xresources >> $HOME/.Xresources
  echo >> $HOME/.Xresources
  cat $DIR/theme.Xresources >> $HOME/.Xresources

  # Reload the new .Xresources file
  xrdb $HOME/.Xresources
  
  # Randomly distribute wallpapers from the wallpapers folder
  echo \
    "feh --no-fehbg --randomize --bg-fill ${DIR}/wallpapers/"'**' > $HOME/.fehbg

  # Run image changing script
  $HOME/.fehbg

  # Echo success message to terminal
  echo "Successfully changed theme to $1. Restart terminal."

  # Restart window manager
  $HOME/.scripts/restart-window-manager

else

  # Create error message
  echo "Error: Couldn't find theme $1"
fi
